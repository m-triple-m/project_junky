{% extends 'base.html' %}

{% block css %}

    <style>
        
    </style>
{% endblock %}
{% block body %}
    <div class="container mt-5" id="top-con">
        
        <div id="list-area">
            <p class="display-4">Scanned Malware List</p>
            <table class="table">
                <thead>
                    <tr>
                        <th>FileName</th>
                        <th>Scan Result</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="scanlist">
                    
                </tbody>
            </table>
    
            <button id="clean" class="btn btn-warning btn-block">Clean Malicious Files</button>
        </div>
        
    </div>
{% endblock %}
{% block js %}
    <script>
        
        $(document).ready(() => {
            
            $('#list-area').hide()
            let data = JSON.parse(sessionStorage.getItem('data'));
            if(data.files.length){
                $('#list-area').show()
                data.files.forEach( element => {
                            $('#scanlist').append(`<tr><td>${element[0]}</td>  <td>${element[1]}</td></tr>`)
                        })
            }else{
                $('#top-con').append(`<p class="display-4 text-center">No Malwares Found</p>`)
            }
            

            removeFiles = () => {
                // $.get('/delJunk', {}, (response) => {
                //     console.log(response)
                //     if(response == 'success'){
                //         Swal.fire(
                //             'Well Done!',
                //             'All Junk files have been removed!!',
                //             'success'
                //             )
                //             location.reload(true);
                //     }
                // })

                $.ajax({url : '/delMalware', data : {path : data.path, files : JSON.stringify(data.files)}, method : "get", complete : (data) => {
                    console.log(data);
                    sessionStorage.removeItem('data');
                    // window.location.replace('/')
                }}
                );
            }

            $('#clean').click(() => {
                removeFiles();
            })

        })
    </script>
{% endblock %}

